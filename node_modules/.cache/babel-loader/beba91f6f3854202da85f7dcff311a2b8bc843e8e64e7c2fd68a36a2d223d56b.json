{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams,useNavigate}from'react-router-dom';import axios from'axios';import'../assets/dashbord.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserProfile=()=>{const[user,setUser]=useState(null);const[selectedFile,setSelectedFile]=useState(null);const[previewUrl,setPreviewUrl]=useState('');const[isEditing,setIsEditing]=useState(false);const{id}=useParams();const navigate=useNavigate();useEffect(()=>{const fetchUser=async()=>{if(!id)return;try{const token=localStorage.getItem('token');const res=await axios.get(`http://localhost:8002/api/view-user-profile/${id}`,{headers:{Authorization:token}});const profileData=res.data.profile;setUser(profileData);if(profileData.profile){setPreviewUrl(`http://localhost:8002/${profileData.profile}`);}}catch(error){console.error('Error fetching user profile:',error);}};fetchUser();},[id]);const handleFileChange=event=>{const file=event.target.files[0];if(file){setSelectedFile(file);setPreviewUrl(URL.createObjectURL(file));}};const handleImageUpload=async()=>{if(!selectedFile)return;const formData=new FormData();formData.append('profile',selectedFile);formData.append('userId',id);// Optional: if your backend needs the user ID\ntry{const token=localStorage.getItem('token');const res=await axios.put('http://localhost:8002/api/update-profile-image',formData,{headers:{Authorization:token,'Content-Type':'multipart/form-data'}});if(res.data.success){setUser({...user,profile:res.data.profile});setPreviewUrl(`http://localhost:8002/${res.data.profile}`);setIsEditing(false);}}catch(error){console.error('Error uploading image:',error);}};if(!user)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/dashboard'),className:\"back-button\",children:\"Back to Dashboard\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-image-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"profile-image-container\",children:[/*#__PURE__*/_jsx(\"img\",{src:previewUrl||\"http://localhost:8002/uploads/images/default-profile.png\",alt:\"Profile\",className:\"profile-image\"}),!isEditing?/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsEditing(true),className:\"edit-button\",children:\"Edit Profile Image\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"image-upload-controls\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleFileChange,className:\"file-input\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleImageUpload,className:\"upload-button\",children:\"Upload\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsEditing(false),className:\"cancel-button\",children:\"Cancel\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Name:\"}),/*#__PURE__*/_jsx(\"p\",{children:user.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email:\"}),/*#__PURE__*/_jsx(\"p\",{children:user.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Verified:\"}),/*#__PURE__*/_jsx(\"p\",{children:user.isVerified?'Yes':'No'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Role:\"}),/*#__PURE__*/_jsx(\"p\",{children:user.role})]})]})]})]});};export default UserProfile;","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","UserProfile","user","setUser","selectedFile","setSelectedFile","previewUrl","setPreviewUrl","isEditing","setIsEditing","id","navigate","fetchUser","token","localStorage","getItem","res","get","headers","Authorization","profileData","data","profile","error","console","handleFileChange","event","file","target","files","URL","createObjectURL","handleImageUpload","formData","FormData","append","put","success","children","className","onClick","src","alt","type","accept","onChange","name","email","isVerified","role"],"sources":["/home/tpss/public_html/Mernstack/authtask/frontend/src/components/UserProfile.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport '../assets/dashbord.css';\n\nconst UserProfile = () => {\n  const [user, setUser] = useState(null);\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [previewUrl, setPreviewUrl] = useState('');\n  const [isEditing, setIsEditing] = useState(false);\n  const { id } = useParams();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      if (!id) return;\n      try {\n        const token = localStorage.getItem('token');\n        const res = await axios.get(`http://localhost:8002/api/view-user-profile/${id}`, {\n          headers: {\n            Authorization: token\n          }\n        });\n\n        const profileData = res.data.profile;\n        setUser(profileData);\n\n        if (profileData.profile) {\n          setPreviewUrl(`http://localhost:8002/${profileData.profile}`);\n        }\n      } catch (error) {\n        console.error('Error fetching user profile:', error);\n      }\n    };\n\n    fetchUser();\n  }, [id]);\n\n  const handleFileChange = (event) => {\n    const file = event.target.files[0];\n    if (file) {\n      setSelectedFile(file);\n      setPreviewUrl(URL.createObjectURL(file));\n    }\n  };\n\n  const handleImageUpload = async () => {\n    if (!selectedFile) return;\n\n    const formData = new FormData();\n    formData.append('profile', selectedFile);\n    formData.append('userId', id); // Optional: if your backend needs the user ID\n\n    try {\n      const token = localStorage.getItem('token');\n      const res = await axios.put(\n        'http://localhost:8002/api/update-profile-image',\n        formData,\n        {\n          headers: {\n            Authorization: token,\n            'Content-Type': 'multipart/form-data',\n          },\n        }\n      );\n\n      if (res.data.success) {\n        setUser({ ...user, profile: res.data.profile });\n        setPreviewUrl(`http://localhost:8002/${res.data.profile}`);\n        setIsEditing(false);\n      }\n    } catch (error) {\n      console.error('Error uploading image:', error);\n    }\n  };\n\n  if (!user) return <p>Loading...</p>;\n\n  return (\n    <div className=\"profile-container\">\n      <div className=\"profile-header\">\n        <h2>User Profile</h2>\n        <button onClick={() => navigate('/dashboard')} className=\"back-button\">\n          Back to Dashboard\n        </button>\n      </div>\n\n      <div className=\"profile-content\">\n        <div className=\"profile-image-section\">\n          <div className=\"profile-image-container\">\n            <img\n              src={previewUrl || \"http://localhost:8002/uploads/images/default-profile.png\"}\n              alt=\"Profile\"\n              className=\"profile-image\"\n            />\n            {!isEditing ? (\n              <button onClick={() => setIsEditing(true)} className=\"edit-button\">\n                Edit Profile Image\n              </button>\n            ) : (\n              <div className=\"image-upload-controls\">\n                <input\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleFileChange}\n                  className=\"file-input\"\n                />\n                <button onClick={handleImageUpload} className=\"upload-button\">\n                  Upload\n                </button>\n                <button onClick={() => setIsEditing(false)} className=\"cancel-button\">\n                  Cancel\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"profile-details\">\n          <div className=\"profile-field\">\n            <label>Name:</label>\n            <p>{user.name}</p>\n          </div>\n          <div className=\"profile-field\">\n            <label>Email:</label>\n            <p>{user.email}</p>\n          </div>\n          <div className=\"profile-field\">\n            <label>Verified:</label>\n            <p>{user.isVerified ? 'Yes' : 'No'}</p>\n          </div>\n          <div className=\"profile-field\">\n            <label>Role:</label>\n            <p>{user.role}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default UserProfile;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}